(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8833:(e,t,o)=>{Promise.resolve().then(o.bind(o,6946))},6946:(e,t,o)=>{"use strict";o.d(t,{default:()=>ew});var r=o(7312),n=o(4447),l=o(2317),i=o(1027),a=o(3463),s=o(9795);function c(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,s.QP)((0,a.$)(t))}let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=n.forwardRef((e,t)=>{let{className:o,variant:n,size:i,asChild:a=!1,...s}=e,h=a?l.DX:"button";return(0,r.jsx)(h,{className:c(d({variant:n,size:i,className:o})),ref:t,...s})});h.displayName="Button";let u=n.forwardRef((e,t)=>{let{className:o,type:n,...l}=e;return(0,r.jsx)("input",{type:n,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),ref:t,...l})});u.displayName="Input";var g=o(6195);let f=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),m=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(g.b,{ref:t,className:c(f(),o),...n})});m.displayName=g.b.displayName;let p=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("textarea",{className:c("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),ref:t,...n})});p.displayName="Textarea";var v=o(5307);let x=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsxs)(v.bL,{ref:t,className:c("relative flex w-full touch-none select-none items-center",o),...n,children:[(0,r.jsx)(v.CC,{className:"relative h-0.5 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,r.jsx)(v.Q6,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(v.zi,{className:"block h-2.5 w-2.5 rounded-full border border-primary bg-background ring-offset-background transition-all duration-200 hover:scale-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});x.displayName=v.bL.displayName;var b=o(6217),w=o(767);let y=b.bL,j=b.l9,N=b.ZL;b.bm;let S=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(b.hJ,{ref:t,className:c("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",o),...n})});S.displayName=b.hJ.displayName;let D=n.forwardRef((e,t)=>{let{className:o,children:n,...l}=e;return(0,r.jsxs)(N,{children:[(0,r.jsx)(S,{}),(0,r.jsxs)(b.UC,{ref:t,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),...l,children:[n,(0,r.jsxs)(b.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(w.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});D.displayName=b.UC.displayName;let C=e=>{let{className:t,...o}=e;return(0,r.jsx)("div",{className:c("flex flex-col space-y-1.5 text-center sm:text-left",t),...o})};C.displayName="DialogHeader";let k=e=>{let{className:t,...o}=e;return(0,r.jsx)("div",{className:c("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...o})};k.displayName="DialogFooter";let z=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(b.hE,{ref:t,className:c("text-lg font-semibold leading-none tracking-tight",o),...n})});z.displayName=b.hE.displayName;let E=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(b.VY,{ref:t,className:c("text-sm text-muted-foreground",o),...n})});E.displayName=b.VY.displayName;var O=o(6954),B=o(7078),I=o(3920),F=o(5686),T=o(8684),R=o(4857),P=o(4505),L=o(4710),W=o(3473),_=o(8003),A=o(670),J=o.n(A);let M=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",o),...n})});M.displayName="Card",n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("flex flex-col space-y-1.5 p-6",o),...n})}).displayName="CardHeader",n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("text-2xl font-semibold leading-none tracking-tight",o),...n})}).displayName="CardTitle",n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("text-sm text-muted-foreground",o),...n})}).displayName="CardDescription";let U=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("p-6 pt-0",o),...n})});U.displayName="CardContent",n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)("div",{ref:t,className:c("flex items-center p-6 pt-0",o),...n})}).displayName="CardFooter";var X=o(434);let H=n.forwardRef((e,t)=>{let{className:o,orientation:n="horizontal",decorative:l=!0,...i}=e;return(0,r.jsx)(X.b,{ref:t,decorative:l,orientation:n,className:c("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",o),...i})});H.displayName=X.b.displayName;var Y=o(6246);let q=Y.bL,G=Y.l9,K=n.forwardRef((e,t)=>{let{className:o,align:n="center",sideOffset:l=4,...i}=e;return(0,r.jsx)(Y.ZL,{children:(0,r.jsx)(Y.UC,{ref:t,align:n,sideOffset:l,className:c("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o),...i})})});K.displayName=Y.UC.displayName;var V=o(7859),Q=o(853);let Z=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(V.uB,{ref:t,className:c("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",o),...n})});Z.displayName=V.uB.displayName;let $=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,r.jsx)(Q.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,r.jsx)(V.uB.Input,{ref:t,className:c("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",o),...n})]})});$.displayName=V.uB.Input.displayName;let ee=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(V.uB.List,{ref:t,className:c("max-h-[300px] overflow-y-auto overflow-x-hidden",o),...n})});ee.displayName=V.uB.List.displayName;let et=n.forwardRef((e,t)=>(0,r.jsx)(V.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));et.displayName=V.uB.Empty.displayName;let eo=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(V.uB.Group,{ref:t,className:c("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",o),...n})});eo.displayName=V.uB.Group.displayName,n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(V.uB.Separator,{ref:t,className:c("-mx-1 h-px bg-border",o),...n})}).displayName=V.uB.Separator.displayName;let er=n.forwardRef((e,t)=>{let{className:o,...n}=e;return(0,r.jsx)(V.uB.Item,{ref:t,className:c("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",o),...n})});er.displayName=V.uB.Item.displayName;var en=o(5800),el=o(8867);function ei(e){var t;let{languages:o,activeLanguage:l,onChange:i}=e,[a,s]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[g,f]=(0,n.useState)(""),[p,v]=(0,n.useState)(""),x=(null===(t=o.find(e=>e.code===l))||void 0===t?void 0:t.name)||l;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(q,{open:a,onOpenChange:s,children:[(0,r.jsx)(G,{asChild:!0,children:(0,r.jsxs)(h,{variant:"outline",role:"combobox","aria-expanded":a,className:"w-[200px] justify-between bg-[#3D3D3D] border-[#4D4D4D] text-gray-300 hover:bg-[#4D4D4D] hover:text-white h-9",children:[x,(0,r.jsx)(en.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,r.jsx)(K,{className:"w-[200px] p-0",children:(0,r.jsxs)(Z,{children:[(0,r.jsx)($,{placeholder:"Search language..."}),(0,r.jsxs)(ee,{children:[(0,r.jsx)(et,{children:"No language found."}),(0,r.jsxs)(eo,{children:[o.map(e=>(0,r.jsxs)(er,{value:e.code,onSelect:()=>{i(e.code),s(!1)},children:[(0,r.jsx)(el.A,{className:"mr-2 h-4 w-4 ".concat(l===e.code?"opacity-100":"opacity-0")}),e.name]},e.code)),(0,r.jsxs)(er,{onSelect:()=>{d(!0),s(!1)},children:[(0,r.jsx)(W.A,{className:"mr-2 h-4 w-4"}),"Add Language"]})]})]})]})})]}),(0,r.jsx)(y,{open:c,onOpenChange:d,children:(0,r.jsxs)(D,{children:[(0,r.jsx)(C,{children:(0,r.jsx)(z,{children:"Add New Language"})}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(m,{htmlFor:"code",className:"text-right",children:"Code"}),(0,r.jsx)(u,{id:"code",value:g,onChange:e=>f(e.target.value),placeholder:"en",className:"col-span-3"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(m,{htmlFor:"name",className:"text-right",children:"Name"}),(0,r.jsx)(u,{id:"name",value:p,onChange:e=>v(e.target.value),placeholder:"English",className:"col-span-3"})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(h,{onClick:()=>{d(!1),f(""),v("")},children:"Add Language"})})]})})]})}let ea=[{code:"en",name:"English"},{code:"ru",name:"Russian"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"zh",name:"Chinese"},{code:"cs",name:"Czech"}],es={orientation:"portrait",backgroundColor:"#007AFF",titleColor:"#FFFFFF",descriptionColor:"#FFFFFF",fontFamily:"SF Pro"},ec=[{value:"top-left",label:"Top Left"},{value:"top-center",label:"Top Center"},{value:"top-right",label:"Top Right"},{value:"center-left",label:"Center Left"},{value:"center",label:"Center"},{value:"center-right",label:"Center Right"},{value:"bottom-left",label:"Bottom Left"},{value:"bottom-center",label:"Bottom Center"},{value:"bottom-right",label:"Bottom Right"}];function ed(e){let{color:t,onChange:o}=e,[l,i]=(0,n.useState)(t),a=(0,n.useRef)(null);return(0,n.useEffect)(()=>{i(t)},[t]),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(q,{children:[(0,r.jsx)(G,{asChild:!0,children:(0,r.jsx)("button",{className:"w-10 h-10 rounded-md border border-input",style:{backgroundColor:t},"aria-label":"Pick a color"})}),(0,r.jsx)(K,{className:"w-64",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"grid grid-cols-6 gap-2",children:["#FF0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#4B0082","#9400D3","#FF1493","#FF69B4","#FFC0CB","#FFFFFF","#000000","#808080","#A52A2A","#D2691E","#FFD700","#008000","#00FFFF"].map(e=>(0,r.jsx)("button",{className:"w-8 h-8 rounded-md border border-input",style:{backgroundColor:e},onClick:()=>{o(e),i(e)},"aria-label":"Select color ".concat(e)},e))}),(0,r.jsx)("input",{ref:a,type:"color",value:l,onChange:e=>{i(e.target.value),o(e.target.value)},className:"w-full h-10"})]})})]}),(0,r.jsx)(u,{value:l,onChange:e=>{let t=e.target.value;i(t),/^#[0-9A-F]{6}$/i.test(t)&&o(t)},className:"w-28",placeholder:"#RRGGBB"})]})}var eh=o(78),eu=o.n(eh);let eg=e=>new Promise((t,o)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=o,r.readAsDataURL(e)}),ef={iphone:{previewWidth:321,previewHeight:694.5,exportWidth:1284,exportHeight:2778,html2canvasScale:4,deviceBaseWidth:220,textBlockWidth:250,placeholderHeight:400},ipad:{previewWidth:516,previewHeight:688,exportWidth:2064,exportHeight:2752,html2canvasScale:4,deviceBaseWidth:280,textBlockWidth:320,placeholderHeight:460}},em=(e,t)=>{if("object"==typeof e.deviceScale&&null!==e.deviceScale){var o;return null!==(o=e.deviceScale[t])&&void 0!==o?o:100}return"number"==typeof e.deviceScale?e.deviceScale:100},ep=(e,t,o)=>{var r,n,l,i;let a=null===(n=e.rotation)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r[o];return"number"==typeof a?a:null!==(i=null===(l=e.rotation)||void 0===l?void 0:l[o])&&void 0!==i?i:0},ev=(e,t,o)=>{var r,n,l,i,a,s,c,d,h,u,g,f,m,p,v,x,b,w,y,j,N,S,D,C;return(console.log("getCurrentScreenshot: Looking for screenshot for preview ".concat(e.id,", device ").concat(o,", language ").concat(t)),(null===(l=e.localizedScreenshots)||void 0===l?void 0:null===(n=l[o])||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.file)||(null===(s=e.localizedScreenshots)||void 0===s?void 0:null===(a=s[o])||void 0===a?void 0:null===(i=a[t])||void 0===i?void 0:i.dataUrl))?(console.log("✓ Found localized screenshot for ".concat(o,"/").concat(t)),e.localizedScreenshots[o][t]):(null===(h=e.localizedScreenshots)||void 0===h?void 0:null===(d=h[o])||void 0===d?void 0:null===(c=d.en)||void 0===c?void 0:c.file)||(null===(f=e.localizedScreenshots)||void 0===f?void 0:null===(g=f[o])||void 0===g?void 0:null===(u=g.en)||void 0===u?void 0:u.dataUrl)?(console.log("⚠️ No screenshot for ".concat(o,"/").concat(t,", using English fallback for same device")),e.localizedScreenshots[o].en):"iphone"!==o&&((null===(v=e.localizedScreenshots)||void 0===v?void 0:null===(p=v.iphone)||void 0===p?void 0:null===(m=p[t])||void 0===m?void 0:m.file)||(null===(w=e.localizedScreenshots)||void 0===w?void 0:null===(b=w.iphone)||void 0===b?void 0:null===(x=b[t])||void 0===x?void 0:x.dataUrl))?(console.log("⚠️ No screenshot for ".concat(o,"/").concat(t,", using iPhone fallback")),e.localizedScreenshots.iphone[t]):"iphone"!==o&&((null===(N=e.localizedScreenshots)||void 0===N?void 0:null===(j=N.iphone)||void 0===j?void 0:null===(y=j.en)||void 0===y?void 0:y.file)||(null===(C=e.localizedScreenshots)||void 0===C?void 0:null===(D=C.iphone)||void 0===D?void 0:null===(S=D.en)||void 0===S?void 0:S.dataUrl))?(console.log("⚠️ No screenshot, using iPhone English fallback"),e.localizedScreenshots.iphone.en):(console.log("⚠️ No localized screenshots, using default screenshot"),e.screenshot)};class ex{initDB(){return new Promise((e,t)=>{if(!window.indexedDB){console.error("Ваш браузер не поддерживает IndexedDB"),t("IndexedDB не поддерживается");return}let o=window.indexedDB.open(this.dbName,this.version);o.onerror=e=>{console.error("Ошибка при открытии базы данных",e),t("Ошибка при открытии базы данных")},o.onsuccess=t=>{this.db=t.target.result,e()},o.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:"id"})}})}async saveImage(e,t){return this.db||await this.initDB(),new Promise((o,r)=>{try{let n=new FileReader;n.onload=()=>{try{let l=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName),i={id:e,data:n.result,type:t.type,lastModified:new Date().getTime()},a=l.put(i);a.onsuccess=()=>o(),a.onerror=e=>{console.error("Error putting data in IndexedDB:",e),r(e)}}catch(e){console.error("Catch error in transaction:",e),r(e)}},n.onerror=e=>r(e),n.readAsDataURL(t)}catch(e){console.error("Outer catch error:",e),r(e)}})}async getImage(e){return this.db||await this.initDB(),new Promise((t,o)=>{try{let r=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);r.onsuccess=()=>{let o=r.result;if(!o){console.log("No image found in IndexedDB for id: ".concat(e)),t(null);return}try{var n;let r=o.data;console.log("Found image data for ".concat(e,", type: ").concat(o.type,", data length: ").concat(r.length));let l=r.split(",");if(2!==l.length||!l[0].startsWith("data:")){console.error("Invalid data URL format for ".concat(e,":"),r.substring(0,100)),t(null);return}let i=(null===(n=l[0].match(/:(.*?);/))||void 0===n?void 0:n[1])||o.type,a=atob(l[1]),s=a.length,c=new Uint8Array(s);for(;s--;)c[s]=a.charCodeAt(s);let d=new Blob([c],{type:i}),h=new File([d],"preview_".concat(e,".").concat(i.split("/")[1]),{type:i,lastModified:o.lastModified});console.log("Successfully reconstructed File for ".concat(e,":"),h.name,h.size,"bytes"),t(h)}catch(o){console.error("Error reconstructing File for ".concat(e,":"),o),t(null)}},r.onerror=t=>{console.error("IndexedDB get error for ".concat(e,":"),t),o(t)}}catch(t){console.error("Outer catch error in getImage for ".concat(e,":"),t),o(t)}})}async deleteImage(e){return this.db||await this.initDB(),new Promise((t,o)=>{try{let r=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);r.onsuccess=()=>t(),r.onerror=e=>o(e)}catch(e){o(e)}})}async clearAll(){return this.db||await this.initDB(),new Promise((e,t)=>{try{let o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();o.onsuccess=()=>e(),o.onerror=e=>t(e)}catch(e){t(e)}})}constructor(){this.db=null,this.dbName="bannerGeneratorDB",this.storeName="screenshots",this.version=1,this.initDB()}}let eb=e=>{let{value:t,onChange:o,min:n,max:l,step:i=1,unit:a,className:s=""}=e;return(0,r.jsxs)("div",{className:"flex items-center gap-2 ".concat(s),children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(x,{value:[t],min:n,max:l,step:i,onValueChange:e=>{let[t]=e;return o(t)},className:"w-full"})}),(0,r.jsxs)("div",{className:"flex items-center gap-1 min-w-[90px]",children:[(0,r.jsx)(u,{type:"number",value:t,onChange:e=>{let t=Number(e.target.value);isNaN(t)||o(Math.min(Math.max(t,n),l))},className:"w-[60px] h-6 px-2 text-[10px] font-mono",min:n,max:l,step:i}),a&&(0,r.jsx)("span",{className:"text-[10px] font-mono text-gray-500",children:a})]})]})};function ew(){var e,t,o,l,i,a,s;let[c,d]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("projects");if(e)return JSON.parse(e)}catch(e){console.error("Error loading projects:",e)}return[{id:1,name:"Project 1",createdAt:Date.now()}]}),[g,f]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("activeProjectId");if(e)return parseInt(e)}catch(e){console.error("Error loading active project:",e)}return 1});(0,n.useEffect)(()=>{localStorage.setItem("projects",JSON.stringify(c)),localStorage.setItem("activeProjectId",String(g))},[c,g]),c.find(e=>e.id===g)||c[0];let v=(e,t,o)=>"project_".concat(g,"_preview_").concat(e,"_").concat(t,"_").concat(o),[x,b]=(0,n.useState)("ru"),w=(0,n.useRef)(x),[N,S]=(0,n.useState)("iphone"),A=ef[N],X=(0,n.useRef)(N);(0,n.useEffect)(()=>{w.current=x},[x]),(0,n.useEffect)(()=>{X.current=N},[N]);let Y=(0,n.useRef)(!1),[q,G]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("bannerSettings");if(e)return JSON.parse(e)}catch(e){console.error("Error loading initial banner settings:",e)}return es}),[K,V]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("localizedContent");if(e)return JSON.parse(e)}catch(e){console.error("Error loading initial localized content:",e)}return{ru:{title:"Новое приложение",description:"Описание приложения",promotionalText:"Рекламный текст",whatsNew:"Что нового в этой версии",keywords:"приложение, ключевые, слова"}}}),[Q,Z]=(0,n.useState)(!1),[$,ee]=(0,n.useState)(""),[et,eo]=(0,n.useState)(0),[er,en]=(0,n.useState)(0),[el,eh]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("textAlignment");if(e)return console.log("Loaded initial text alignment from localStorage:",e),e}catch(e){console.error("Error loading initial text alignment:",e)}return"center"}),[ew,ey]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("fontSize");if(e)return console.log("Loaded initial font size from localStorage"),JSON.parse(e)}catch(e){console.error("Error loading initial font size:",e)}return{title:24,description:16}}),[ej,eN]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("lineHeight");if(e)return console.log("Loaded initial line height from localStorage"),JSON.parse(e)}catch(e){console.error("Error loading initial line height:",e)}return{title:"auto",description:"auto"}}),[eS,eD]=(0,n.useState)(()=>{if(window.localStorage)try{let e=localStorage.getItem("letterSpacing");if(e)return console.log("Loaded initial letter spacing from localStorage"),JSON.parse(e)}catch(e){console.error("Error loading initial letter spacing:",e)}return{title:0,description:0}});(0,n.useRef)(null);let eC=(0,n.useRef)(null),[ek,ez]=(0,n.useState)("banner"),[eE,eO]=(0,n.useState)(null),[eB,eI]=(0,n.useState)(null),eF=(0,n.useRef)(null),[eT,eR]=(0,n.useState)(0),eP=()=>eR(e=>e+1);(0,n.useEffect)(()=>(eF.current||(eF.current=new ex,eF.current.initDB().catch(e=>console.error("Ошибка при инициализации IndexedDB:",e))),()=>{}),[]);let[eL,eW]=(0,n.useState)(()=>{let e={id:1,name:"Preview 1",backgroundColor:"#FFD700",devicePosition:"center",deviceScale:100,rotation:{device:0,title:0,description:0,textBlock:0},verticalOffset:{combined:0,title:0,description:0,device:0},horizontalOffset:{combined:0,title:0,description:0},screenshot:{file:null,borderColor:"#000000",borderWidth:8,borderRadius:30}};if(window.localStorage)try{let t=localStorage.getItem("activeProjectId"),o=t?parseInt(t):1,r=localStorage.getItem("project_".concat(o,"_previewItems"));if(r){let t=JSON.parse(r);if(console.log("Loaded preview items for project ".concat(o,":"),t),t&&"object"==typeof t&&!Array.isArray(t)&&(t.iphone||t.ipad))return{iphone:t.iphone||[e],ipad:t.ipad||[e]};if(Array.isArray(t)&&t.length>0)return console.log("\uD83D\uDCE6 Migrating old format to device-specific structure"),{iphone:t,ipad:JSON.parse(JSON.stringify(t))}}}catch(e){console.error("Error loading initial preview items:",e)}return{iphone:[e],ipad:[{...e}]}});(0,n.useEffect)(()=>{if(window.localStorage){console.log("Checking for additional data in localStorage");try{let e=localStorage.getItem("localizedContent");if(e){let t=JSON.parse(e);V(t)}let t=localStorage.getItem("textAlignment");t&&eh(t);let o=localStorage.getItem("fontSize");o&&ey(JSON.parse(o));let r=localStorage.getItem("lineHeight");r&&eN(JSON.parse(r));let n=localStorage.getItem("letterSpacing");n&&eD(JSON.parse(n))}catch(e){console.error("Error loading additional data from localStorage:",e)}}},[]);let e_=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(window.localStorage&&eL&&(eL.iphone||eL.ipad))return e_.current&&clearTimeout(e_.current),e_.current=setTimeout(()=>{if(Y.current){console.log("⏭️ Skipping save - project is loading");return}try{var e,t,o,r,n,l,i,a,s;null===(e=eL.iphone)||void 0===e||e.length,null===(t=eL.ipad)||void 0===t||t.length,console.log("Saving previewItems to localStorage - iPhone: ".concat((null===(o=eL.iphone)||void 0===o?void 0:o.length)||0,", iPad: ").concat((null===(r=eL.ipad)||void 0===r?void 0:r.length)||0));let c=e=>({id:e.id,name:e.name,backgroundColor:e.backgroundColor,devicePosition:e.devicePosition,deviceScale:e.deviceScale,rotation:e.rotation,verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset,screenshot:{borderColor:e.screenshot.borderColor,borderWidth:e.screenshot.borderWidth,borderRadius:e.screenshot.borderRadius}}),d={iphone:(null===(n=eL.iphone)||void 0===n?void 0:n.map(c))||[],ipad:(null===(l=eL.ipad)||void 0===l?void 0:l.map(c))||[]},h=JSON.stringify(d),u=new Blob([h]).size/1024;console.log("\uD83D\uDCBE [v2.4] Saving ".concat(u.toFixed(2),"KB to localStorage for project ").concat(g," (images excluded)")),console.log("\uD83D\uDCBE [v2.4] iPhone preview 1 rotation.device: ".concat(null!==(s=null===(a=d.iphone[0])||void 0===a?void 0:null===(i=a.rotation)||void 0===i?void 0:i.device)&&void 0!==s?s:"undefined"));let f="project_".concat(g,"_previewItems");localStorage.setItem(f,h)}catch(e){e instanceof DOMException&&"QuotaExceededError"===e.name?console.error("❌ localStorage quota exceeded even with minimal data!",e):console.error("Error saving preview items:",e)}},500),()=>{e_.current&&clearTimeout(e_.current)}},[eL]),(0,n.useEffect)(()=>{var e,t,o,r,n,l,i,a;console.log("\uD83D\uDD04 [v2.4] Switching to project ".concat(g)),console.log("\uD83D\uDD04 [v2.4] Current iPhone items: ".concat(null!==(o=null===(e=eL.iphone)||void 0===e?void 0:e.length)&&void 0!==o?o:0,", iPad items: ").concat(null!==(r=null===(t=eL.ipad)||void 0===t?void 0:t.length)&&void 0!==r?r:0)),Y.current=!0,e_.current&&(clearTimeout(e_.current),e_.current=null,console.log("\uD83E\uDDF9 Cleared pending save timer"));let s={id:1,name:"Preview 1",backgroundColor:"#FFD700",devicePosition:"center",deviceScale:100,rotation:{device:0,title:0,description:0,textBlock:0},verticalOffset:{combined:0,title:0,description:0,device:0},horizontalOffset:{combined:0,title:0,description:0},screenshot:{file:null,borderColor:"#000000",borderWidth:8,borderRadius:30}};if(window.localStorage)try{let e="project_".concat(g,"_previewItems"),t=localStorage.getItem(e);if(t){let e=JSON.parse(t);e&&"object"==typeof e&&!Array.isArray(e)?e.iphone||e.ipad?(console.log("✅ [v2.4] Loaded device-specific items - iPhone: ".concat(null!==(i=null===(n=e.iphone)||void 0===n?void 0:n.length)&&void 0!==i?i:0,", iPad: ").concat(null!==(a=null===(l=e.ipad)||void 0===l?void 0:l.length)&&void 0!==a?a:0)),eW({iphone:e.iphone||[s],ipad:e.ipad||[s]})):(console.log("No saved preview data for project ".concat(g,", using default")),eW({iphone:[s],ipad:[{...s}]})):Array.isArray(e)&&e.length>0?(console.log("\uD83D\uDCE6 [v2.4] Migrating old format (".concat(e.length," items) to device-specific structure")),eW({iphone:e,ipad:JSON.parse(JSON.stringify(e))})):(console.log("No saved preview data for project ".concat(g,", using default")),eW({iphone:[s],ipad:[{...s}]}))}else console.log("No saved preview data for project ".concat(g,", using default")),eW({iphone:[s],ipad:[{...s}]});let o="project_".concat(g,"_bannerSettings"),r=localStorage.getItem(o);r?(G(JSON.parse(r)),console.log("Loaded banner settings for project ".concat(g))):(G(es),console.log("No saved settings for project ".concat(g,", using defaults")));let c="project_".concat(g,"_localizedContent"),d=localStorage.getItem(c);d?(V(JSON.parse(d)),console.log("Loaded localized content for project ".concat(g))):(V({ru:{title:"Новое приложение",description:"Описание приложения",promotionalText:"Рекламный текст",whatsNew:"Что нового в этой версии",keywords:"приложение, ключевые, слова"}}),console.log("No saved content for project ".concat(g,", using defaults")))}catch(e){console.error("Error loading project data:",e)}let c=setTimeout(()=>{Y.current=!1,console.log("Project ".concat(g," loading complete"))},100);return()=>clearTimeout(c)},[g]),(0,n.useEffect)(()=>{var e,t;console.log("\uD83D\uDE80 App Screen Generator v".concat("2.4.0-rotation-handles"," initialized")),console.log("Initializing IndexedDB and loading images"),eF.current||(eF.current=new ex);let o=async()=>{if(console.log("Loading images from IndexedDB..."),eF.current)try{let e=new Map,t=new Map,o=eL.iphone||[];for(let t=0;t<o.length;t++){let r=o[t],n={screenshot:null,localizedScreenshots:{}},l="preview_".concat(r.id);try{let e=await eF.current.getImage(l);if(e){console.log("Loaded default image for preview ".concat(l));let t=await eg(e);n.screenshot={file:e,dataUrl:t,borderColor:r.screenshot.borderColor,borderWidth:r.screenshot.borderWidth,borderRadius:r.screenshot.borderRadius}}}catch(e){console.error("Error loading default image for ".concat(l,":"),e)}for(let e of ea){let t="preview_".concat(r.id,"_").concat(e.code);try{let o=await eF.current.getImage(t);if(o){console.log("Loaded legacy localized image for ".concat(t));let l=await eg(o);n.localizedScreenshots.iphone||(n.localizedScreenshots.iphone={}),n.localizedScreenshots.iphone[e.code]={file:o,dataUrl:l,borderColor:r.screenshot.borderColor,borderWidth:r.screenshot.borderWidth,borderRadius:r.screenshot.borderRadius}}}catch(e){}}for(let e of["iphone","ipad"])for(let t of ea){let o=v(r.id,e,t.code),l="preview_".concat(r.id,"_").concat(e,"_").concat(t.code);try{let i=await eF.current.getImage(o),a=o;if(i||(i=await eF.current.getImage(l),a=l),i){console.log("Loaded device-specific image from ".concat(a));let o=await eg(i);n.localizedScreenshots[e]||(n.localizedScreenshots[e]={}),n.localizedScreenshots[e][t.code]={file:i,dataUrl:o,borderColor:r.screenshot.borderColor,borderWidth:r.screenshot.borderWidth,borderRadius:r.screenshot.borderRadius}}}catch(e){console.error("Error loading device-specific image:",e)}}(n.screenshot||Object.keys(n.localizedScreenshots).length>0)&&e.set(t,n)}let r=eL.ipad||[];for(let e=0;e<r.length;e++){let o=r[e],n={screenshot:null,localizedScreenshots:{}},l="preview_".concat(o.id);try{let e=await eF.current.getImage(l);if(e){console.log("Loaded default image for preview ".concat(l));let t=await eg(e);n.screenshot={file:e,dataUrl:t,borderColor:o.screenshot.borderColor,borderWidth:o.screenshot.borderWidth,borderRadius:o.screenshot.borderRadius}}}catch(e){console.error("Error loading default image for ".concat(l,":"),e)}for(let e of["iphone","ipad"])for(let t of ea){let r=v(o.id,e,t.code),l="preview_".concat(o.id,"_").concat(e,"_").concat(t.code);try{let i=await eF.current.getImage(r),a=r;if(i||(i=await eF.current.getImage(l),a=l),i){console.log("Loaded device-specific image from ".concat(a));let r=await eg(i);n.localizedScreenshots[e]||(n.localizedScreenshots[e]={}),n.localizedScreenshots[e][t.code]={file:i,dataUrl:r,borderColor:o.screenshot.borderColor,borderWidth:o.screenshot.borderWidth,borderRadius:o.screenshot.borderRadius}}}catch(e){console.error("Error loading device-specific image:",e)}}(n.screenshot||Object.keys(n.localizedScreenshots).length>0)&&t.set(e,n)}let n=e.size+t.size;n>0&&(console.log("\uD83D\uDCE5 Loaded ".concat(n," images from IndexedDB (iPhone: ").concat(e.size,", iPad: ").concat(t.size,")")),eW(o=>{let r=(o.iphone||[]).map((t,o)=>{let r=e.get(o);if(r){let e={...t};if(r.screenshot&&(e.screenshot={...e.screenshot,...r.screenshot}),Object.keys(r.localizedScreenshots).length>0)for(let t of(e.localizedScreenshots||(e.localizedScreenshots={}),Object.keys(r.localizedScreenshots)))for(let o of(e.localizedScreenshots[t]||(e.localizedScreenshots[t]={}),Object.keys(r.localizedScreenshots[t]))){let n=e.localizedScreenshots[t][o];(null==n?void 0:n.file)&&n.file instanceof File?console.log("⏭️ Skipping IndexedDB load for ".concat(t,"/").concat(o," - already has File in memory")):e.localizedScreenshots[t][o]=r.localizedScreenshots[t][o]}return e}return t}),n=(o.ipad||[]).map((e,o)=>{let r=t.get(o);if(r){let t={...e};if(r.screenshot&&(t.screenshot={...t.screenshot,...r.screenshot}),Object.keys(r.localizedScreenshots).length>0)for(let e of(t.localizedScreenshots||(t.localizedScreenshots={}),Object.keys(r.localizedScreenshots)))for(let o of(t.localizedScreenshots[e]||(t.localizedScreenshots[e]={}),Object.keys(r.localizedScreenshots[e]))){let n=t.localizedScreenshots[e][o];(null==n?void 0:n.file)&&n.file instanceof File?console.log("⏭️ Skipping IndexedDB load for ".concat(e,"/").concat(o," - already has File in memory")):t.localizedScreenshots[e][o]=r.localizedScreenshots[e][o]}return t}return e});return{iphone:r,ipad:n}}))}catch(e){console.error("Error loading images from IndexedDB:",e)}};(((null===(e=eL.iphone)||void 0===e?void 0:e.length)||0)>0||((null===(t=eL.ipad)||void 0===t?void 0:t.length)||0)>0)&&o()},[((null===(e=eL.iphone)||void 0===e?void 0:e.length)||0)+((null===(t=eL.ipad)||void 0===t?void 0:t.length)||0),g,null===(l=eL.iphone)||void 0===l?void 0:null===(o=l[0])||void 0===o?void 0:o.id,null===(a=eL.ipad)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.id]),(0,n.useEffect)(()=>{let e=setTimeout(async()=>{let e=eL[N]||[];if(!eF.current||0===e.length){console.log("Skipping image loading: imageDB=".concat(!!eF.current,", previewItems=").concat(e.length));return}console.log("\uD83D\uDD04 Loading images for language: ".concat(x));let t=new Map;for(let n=0;n<e.length;n++){var o,r;let l=e[n];console.log("Checking preview ".concat(l.id," for language ").concat(x));let i=null===(r=l.localizedScreenshots)||void 0===r?void 0:null===(o=r[N])||void 0===o?void 0:o[x];if(null==i?void 0:i.file){console.log("✓ Preview ".concat(l.id," already has screenshot for ").concat(x));continue}let a=v(l.id,N,x),s="preview_".concat(l.id,"_").concat(x);console.log("\uD83D\uDD04 useEffect: Attempting to load image for preview ".concat(l.id,", trying ").concat(a));try{let e=await eF.current.getImage(a),o=a;if(e||(e=await eF.current.getImage(s),o=s),e){console.log("✅ useEffect: Loaded localized image from ".concat(o,", size: ").concat(e.size," bytes"));let r=await eg(e);t.set(n,{file:e,dataUrl:r,borderColor:l.screenshot.borderColor,borderWidth:l.screenshot.borderWidth,borderRadius:l.screenshot.borderRadius}),console.log("\uD83D\uDD04 useEffect: Loaded image for preview ".concat(l.id,", index ").concat(n))}else console.log("❌ useEffect: No image found for preview ".concat(l.id))}catch(e){console.error("\uD83D\uDCA5 Error loading localized image:",e)}}t.size>0?(console.log("\uD83D\uDD04 [v2.3] Updating state with new images for ".concat(x,", loaded ").concat(t.size," images")),eW(e=>{let o=(e[N]||[]).map((e,o)=>{let r=t.get(o);if(r){let t={...e};return t.localizedScreenshots||(t.localizedScreenshots={}),t.localizedScreenshots[N]||(t.localizedScreenshots[N]={}),t.localizedScreenshots[N][x]=r,t}return e});return{...e,[N]:o}}),eP()):console.log("ℹ️ No new images loaded for ".concat(x))},200);return()=>clearTimeout(e)},[x,null===(s=eL[N])||void 0===s?void 0:s.length,g,N]),(0,n.useEffect)(()=>{if(window.localStorage&&K&&!Y.current)try{let e="project_".concat(g,"_localizedContent");localStorage.setItem(e,JSON.stringify(K))}catch(e){console.error("Error saving localized content:",e)}},[K]),(0,n.useEffect)(()=>{if(window.localStorage&&q&&!Y.current)try{let e="project_".concat(g,"_bannerSettings");localStorage.setItem(e,JSON.stringify(q))}catch(e){console.error("Error saving banner settings:",e)}},[q]),(0,n.useEffect)(()=>{if(window.localStorage&&el)try{localStorage.setItem("textAlignment",el)}catch(e){console.error("Error saving text alignment:",e)}},[el]),(0,n.useEffect)(()=>{if(window.localStorage&&ew)try{localStorage.setItem("fontSize",JSON.stringify(ew))}catch(e){console.error("Error saving font size:",e)}},[ew]),(0,n.useEffect)(()=>{if(window.localStorage&&ej)try{localStorage.setItem("lineHeight",JSON.stringify(ej))}catch(e){console.error("Error saving line height:",e)}},[ej]),(0,n.useEffect)(()=>{if(window.localStorage&&eS)try{localStorage.setItem("letterSpacing",JSON.stringify(eS))}catch(e){console.error("Error saving letter spacing:",e)}},[eS]);let eA=e=>{console.log("\uD83D\uDCF1 Device type changed to ".concat(e)),S(e)},eJ=(e,t,o)=>{let r={...K};r[e]||(r[e]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""}),r[e][t]=o,V(r)},eM=(e,t)=>{var o;return K[e]&&(null===(o=K[e])||void 0===o?void 0:o[t])||""},eU=(e,t,o)=>{var r;if(!K[e])return"";let n="preview_".concat(t,"_").concat(o);return(null===(r=K[e])||void 0===r?void 0:r[n])||""},eX=async(e,t,o)=>{try{let r=t||w.current,n=o||X.current;console.log("\uD83D\uDCE4 handleScreenshotUpload: Starting upload for preview ".concat(er,", device=").concat(n,", language ").concat(r,", file size: ").concat(e.size," bytes"));let l=await eg(e);console.log("\uD83D\uDCE4 Converted file to data URL, length: ".concat(l.length));let i=[...eL[n]||[]];if(i[er]){let t=i[er];if(console.log("\uD83D\uDCE4 Processing preview ".concat(t.id)),t.localizedScreenshots||(t.localizedScreenshots={},console.log("\uD83D\uDCE4 Initialized localizedScreenshots for preview ".concat(t.id))),t.localizedScreenshots[n]||(t.localizedScreenshots[n]={},console.log("\uD83D\uDCE4 Initialized localizedScreenshots[".concat(n,"] for preview ").concat(t.id))),t.localizedScreenshots[n][r]={file:e,dataUrl:l,borderColor:t.screenshot.borderColor,borderWidth:t.screenshot.borderWidth,borderRadius:t.screenshot.borderRadius},console.log("\uD83D\uDCE4 Set localized screenshot for ".concat(n,"/").concat(r," in state with dataUrl")),eW(e=>({...e,[n]:i})),console.log("\uD83D\uDCE4 Updated React state"),eP(),console.log("\uD83D\uDCE4 Forced UI update"),eF.current){let o=v(t.id,n,r);console.log("\uD83D\uDCBE Saving to IndexedDB with project isolation: ".concat(o)),await eF.current.saveImage(o,e),console.log("✅ Successfully saved image for ".concat(n,"/").concat(r,": ").concat(o))}console.log("\uD83C\uDF89 Upload complete, position should still be:",t.devicePosition)}else console.error("❌ Preview ".concat(er," not found in previewItems"))}catch(e){console.error("\uD83D\uDCA5 Error in handleScreenshotUpload:",e)}},eH=e=>{let t=eL[N]||[],o=t.find(t=>t.id===e);if(!o)return;let r=[...(eL.iphone||[]).map(e=>e.id),...(eL.ipad||[]).map(e=>e.id)],n=r.length>0?Math.max(...r)+1:1,l={...o,id:n,name:"Preview ".concat(n),screenshot:{...o.screenshot,file:o.screenshot.file?o.screenshot.file:null}};eW(e=>({...e,[N]:[...e[N]||[],l]}));let i={...K};Object.keys(i).forEach(t=>{i[t]&&(i[t]["preview_".concat(n,"_title")]=i[t]["preview_".concat(e,"_title")]||"",i[t]["preview_".concat(n,"_description")]=i[t]["preview_".concat(e,"_description")]||"")}),V(i),en(t.length),setTimeout(()=>{eC.current&&(eC.current.scrollLeft=eC.current.scrollWidth)},100)},eY=e=>{let t=eL[N]||[];if(t.length<=1)return;eF.current&&eF.current.deleteImage("preview_".concat(e)).catch(e=>console.error("Error deleting image from IndexedDB:",e));let o=t.filter(t=>t.id!==e);eW(e=>({...e,[N]:o})),er>=o.length&&en(o.length-1)},eq=(e,t)=>{let o=[...eL[N]||[]];if(o[er]){var r,n;let l=o[er],i={...l.screenshot,[e]:t},a=l.localizedScreenshots;(null===(n=l.localizedScreenshots)||void 0===n?void 0:null===(r=n[N])||void 0===r?void 0:r[x])&&(a={...l.localizedScreenshots,[N]:{...l.localizedScreenshots[N],[x]:{...l.localizedScreenshots[N][x],[e]:t}}}),o[er]={...l,screenshot:i,localizedScreenshots:a},eW(e=>({...e,[N]:o}))}},eG=e=>{var t,o,r,n,l;if(!e)return{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"".concat(A.deviceBaseWidth,"px")};let i=e.devicePosition||"center",a=em(e,N),s=(null===(o=e.verticalOffset)||void 0===o?void 0:null===(t=o[N])||void 0===t?void 0:t.device)||(null===(r=e.verticalOffset)||void 0===r?void 0:r.device)||0,c=(null===(l=e.horizontalOffset)||void 0===l?void 0:null===(n=l[N])||void 0===n?void 0:n.device)||0,d=ep(e,N,"device"),h=A.deviceBaseWidth,u={position:"absolute",width:"".concat(h*a/100,"px")};switch(i){case"top-left":u={...u,top:"-35%",left:"-15%",transform:"translateX(".concat(c,"px) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;case"top-center":u={...u,top:"-35%",left:"50%",transform:"translateX(calc(-50% + ".concat(c,"px)) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;case"top-right":u={...u,top:"-35%",right:"-15%",transform:"translateX(".concat(c,"px) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;case"center-left":u={...u,top:"50%",left:"-25%",transform:"translateX(".concat(c,"px) translateY(calc(-50% + ").concat(s,"px)) rotate(").concat(d,"deg)")};break;case"center":u={...u,top:"50%",left:"50%",transform:"translate(calc(-50% + ".concat(c,"px), calc(-50% + ").concat(s,"px)) rotate(").concat(d,"deg)"),zIndex:"10",margin:"0 auto"};break;case"center-right":u={...u,top:"50%",right:"-25%",transform:"translateX(".concat(c,"px) translateY(calc(-50% + ").concat(s,"px)) rotate(").concat(d,"deg)")};break;case"bottom-left":u={...u,bottom:"-35%",left:"-15%",transform:"translateX(".concat(c,"px) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;case"bottom-center":u={...u,bottom:"-35%",left:"50%",transform:"translateX(calc(-50% + ".concat(c,"px)) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;case"bottom-right":u={...u,bottom:"-35%",right:"-15%",transform:"translateX(".concat(c,"px) translateY(").concat(s,"px) rotate(").concat(d,"deg)")};break;default:u={...u,top:"50%",left:"50%",transform:"translate(calc(-50% + ".concat(c,"px), calc(-50% + ").concat(s,"px)) rotate(").concat(d,"deg)")}}return u},eK=e=>{let t={},o={};return"center"===e?{titlePosition:t={top:"8%",left:"50%",transform:"translateX(-50%)",width:"".concat(ef[N].textBlockWidth,"px"),textAlign:"center",zIndex:"5"},descriptionPosition:{bottom:"15%",left:"50%",transform:"translateX(-50%)",width:"".concat(ef[N].textBlockWidth,"px"),textAlign:"center",zIndex:"5"},separateElements:!0}:e.startsWith("top")?{titlePosition:t={bottom:"15%",left:"50%",transform:"translateX(-50%)",width:"".concat(ef[N].textBlockWidth,"px")},descriptionPosition:{},separateElements:!1}:e.startsWith("bottom")?{titlePosition:t={top:"15%",left:"50%",transform:"translateX(-50%)",width:"".concat(ef[N].textBlockWidth,"px")},descriptionPosition:{},separateElements:!1}:e.endsWith("left")?{titlePosition:t={top:"50%",right:"15%",transform:"translateY(-50%)",width:"".concat(ef[N].textBlockWidth,"px")},descriptionPosition:{},separateElements:!1}:e.endsWith("right")?{titlePosition:t={top:"50%",left:"15%",transform:"translateY(-50%)",width:"".concat(ef[N].textBlockWidth,"px")},descriptionPosition:{},separateElements:!1}:{titlePosition:t={top:"15%",left:"50%",transform:"translateX(-50%)",width:"250px"},descriptionPosition:{},separateElements:!1}},eV=async e=>{if(e.target.files&&e.target.files[0])try{let t=e.target.files[0],o=await t.text(),r=JSON.parse(o);if(!r.global||!r.banners)throw Error("Неверный формат JSON: отсутствуют разделы global или banners");let n={};Object.entries(r.global).forEach(e=>{let[t,o]=e;n[t]||(n[t]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""}),n[t]={...n[t],title:o.title||"",description:o.description||"",promotionalText:o.promotionalText||"",whatsNew:o.whatsNew||"",keywords:o.keywords||""}}),Object.entries(r.banners).forEach(e=>{let[t,o]=e;n[t]||(n[t]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""}),Object.entries(o).forEach(e=>{let[o,r]=e;n[t]["".concat(o,"_title")]=r.title||"",n[t]["".concat(o,"_description")]=r.description||""})}),V(n),e.target.value="",alert("JSON успешно импортирован!")}catch(e){console.error("Ошибка при импорте JSON:",e),alert("Ошибка при импорте JSON. Проверьте формат файла.")}};(0,n.useEffect)(()=>{let e=e=>{document.querySelectorAll(".banner-device-target").forEach(t=>{e?t.classList.add("drag-highlight"):t.classList.remove("drag-highlight")})},t=t=>{t.preventDefault(),t.stopPropagation(),e(!0)},o=t=>{t.relatedTarget||e(!1)},r=t=>{var o;if(t.preventDefault(),t.stopPropagation(),console.log("\uD83C\uDFAF handleDrop: Drop event detected"),e(!1),!(null===(o=t.dataTransfer)||void 0===o?void 0:o.files)||!t.dataTransfer.files[0]){console.log("❌ handleDrop: No files in drop event");return}let r=t.dataTransfer.files[0],i=w.current;console.log("\uD83D\uDCC4 handleDrop: Processing file: ".concat(r.name,", size: ").concat(r.size," bytes, activeLanguage=").concat(i)),console.log("\uD83D\uDCC4 handleDrop: activeLanguageRef at drop time:",i);let a=n(t);if(console.log("\uD83C\uDFAF handleDrop: Target element found:",a?"banner-".concat(a.dataset.bannerId):"none"),a){let e=parseInt(a.dataset.bannerId||"-1");if(console.log("\uD83C\uDFAF handleDrop: Target banner ID: ".concat(e)),e>=0){console.log("\uD83D\uDD04 handleDrop: Setting preview index to ".concat(e)),en(e),console.log("\uD83D\uDCE4 handleDrop: Calling uploadScreenshotToBanner for banner ".concat(e," with language ").concat(i,", device ").concat(X.current)),l(r,e,i,X.current);return}}console.log("\uD83D\uDCE4 handleDrop: No specific target, calling handleScreenshotUpload for current preview ".concat(er)),eX(r)},n=e=>{let t=document.querySelectorAll(".banner-device-target");for(let o of(console.log("\uD83D\uDD0D findDropTarget: Found ".concat(t.length," drop targets, mouse at (").concat(e.clientX,", ").concat(e.clientY,")")),t)){let t=o.getBoundingClientRect(),r=o.dataset.bannerId;if(console.log("\uD83D\uDD0D findDropTarget: Checking banner-".concat(r,": rect(").concat(t.left,", ").concat(t.top,", ").concat(t.right,", ").concat(t.bottom,")")),e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom)return console.log("✅ findDropTarget: Found matching target: banner-".concat(r)),o}return console.log("❌ findDropTarget: No matching target found"),null},l=async(e,t,o,r)=>{try{let n=o||w.current,l=r||N;console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Starting upload to banner ".concat(t,", device=").concat(l,", language=").concat(n,", file size: ").concat(e.size," bytes"));let i=await eg(e);console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Converted file to data URL, length: ".concat(i.length));let a=[...eL[l]||[]];if(a[t]){let o=a[t],r={...o,localizedScreenshots:o.localizedScreenshots?{...o.localizedScreenshots}:{}};if(r.localizedScreenshots[l]?r.localizedScreenshots[l]={...r.localizedScreenshots[l]}:r.localizedScreenshots[l]={},console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Processing banner ".concat(r.id)),console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Current localizedScreenshots:",r.localizedScreenshots),console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Before setting - localizedScreenshots[".concat(l,"] keys:"),Object.keys(r.localizedScreenshots[l])),r.localizedScreenshots[l][n]={file:e,dataUrl:i,borderColor:r.screenshot.borderColor,borderWidth:r.screenshot.borderWidth,borderRadius:r.screenshot.borderRadius},console.log("\uD83D\uDCE4 uploadScreenshotToBanner: After setting - localizedScreenshots keys:",Object.keys(r.localizedScreenshots)),console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Set localized screenshot for ".concat(n," in state with dataUrl")),a[t]=r,eW(e=>({...e,[l]:a})),console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Updated React state"),eP(),console.log("\uD83D\uDCE4 uploadScreenshotToBanner: Forced UI update"),eF.current){let o=v(r.id,l,n);console.log("\uD83D\uDCBE uploadScreenshotToBanner: Saving to IndexedDB with project isolation: ".concat(o)),await eF.current.saveImage(o,e),console.log("✅ uploadScreenshotToBanner: Successfully saved image for banner ".concat(t,": ").concat(o))}}else console.error("❌ uploadScreenshotToBanner: Banner ".concat(t," not found in previewItems"))}catch(e){console.error("\uD83D\uDCA5 Error in uploadScreenshotToBanner:",e)}};return window.addEventListener("dragover",t),window.addEventListener("dragleave",o),window.addEventListener("drop",r),()=>{window.removeEventListener("dragover",t),window.removeEventListener("dragleave",o),window.removeEventListener("drop",r)}},[er,eL]);let[eQ,eZ]=(0,n.useState)(()=>ea.reduce((e,t)=>(e[t.code]=!0,e),{})),e$=e=>{eZ(t=>({...t,[e]:!t[e]}))},e0=e=>{let t={};ea.forEach(o=>{t[o.code]=e}),eZ(t)},e1=async()=>{Z(!0),eo(0);try{var e,t;console.log("Начинаем процесс экспорта..."),eF.current||(console.log("Инициализируем IndexedDB..."),eF.current=new ex,await new Promise(e=>setTimeout(e,500)));let o=new(J()),r=Object.keys(eQ).filter(e=>eQ[e]);if(0===r.length){alert("Пожалуйста, выберите хотя бы один язык для экспорта"),Z(!1);return}console.log("Выбранные языки для экспорта:",r);let n=((null===(e=eL[N])||void 0===e?void 0:e.length)||0)*r.length,l=0;for(let e of r){let r=o.folder(e);if(!r)continue;let i=eL[N]||[];for(let o=0;o<i.length;o++)try{b(e),en(o),await new Promise(e=>setTimeout(e,100));let t=i[o];console.log("Экспорт баннера #".concat(t.id," для языка ").concat(e));let a=document.getElementById("preview-".concat(t.id));if(!a){console.error("Не найден элемент с ID preview-".concat(t.id));continue}let s=a.cloneNode(!0);document.body.appendChild(s);try{s.querySelectorAll(".banner-controls, .banner-edit-icons, button").forEach(e=>{var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}),s.querySelectorAll('[class*="hover:"]').forEach(e=>{let t=e.className.split(" ").filter(e=>!e.includes("hover:"));e.className=t.join(" ")}),s.querySelectorAll(".banner-content").forEach(e=>{e instanceof HTMLElement&&e.classList.remove("border","border-blue-500","shadow-xl")}),s.style.position="absolute",s.style.left="-9999px",s.style.top="0",s.style.zIndex="-1",s.style.transform="none",s.style.margin="0",s.style.padding="0",s.style.borderRadius="0",s.style.width="".concat(ef[N].previewWidth,"px"),s.style.height="".concat(ef[N].previewHeight,"px"),s.style.boxSizing="border-box";let e=s.querySelector(".banner-device-target"),o=s.querySelector(".banner-text-container"),i="",a="";e instanceof HTMLElement&&(i=e.style.transform),o instanceof HTMLElement&&(a=o.style.transform);let c=ef[N].exportWidth,d=ef[N].exportHeight;console.log("Экспорт с размерами: ".concat(c,"x").concat(d," для устройства ").concat(N)),console.log("Preview размер: ".concat(ef[N].previewWidth,"x").concat(ef[N].previewHeight,", scale: ").concat(A.html2canvasScale));let h=await eu()(s,{scale:A.html2canvasScale,useCORS:!0,allowTaint:!0,backgroundColor:t.backgroundColor||"#ffffff",logging:!1,removeContainer:!1,onclone:(e,t)=>{let o=e.querySelector(".banner-device-target"),r=e.querySelector(".banner-text-container");return o instanceof HTMLElement&&i&&(o.style.transform=i),r instanceof HTMLElement&&a&&(r.style.transform=a),t}});console.log("Canvas размер от html2canvas: ".concat(h.width,"x").concat(h.height));let u=document.createElement("canvas");u.width=c,u.height=d;let g=u.getContext("2d");g&&g.drawImage(h,0,0,h.width,h.height,0,0,c,d);let f=await new Promise((e,t)=>{u.toBlob(o=>{o?e(o):t(Error("Failed to create blob"))},"image/png",1)});r.file("banner_".concat(t.id,".png"),f),l++,eo(Math.floor(l/n*100))}finally{s.parentNode&&document.body.removeChild(s)}}catch(e){console.error("Ошибка при экспорте баннера ".concat(null===(t=i[o])||void 0===t?void 0:t.id,":"),e)}}b(x),en(er),console.log("Генерация архива...");let i=await o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}});console.log("Размер архива: ".concat(i.size," байт")),(0,_.saveAs)(i,"app_banners.zip"),console.log("Экспорт завершен успешно!")}catch(e){console.error("Ошибка при экспорте:",e),alert("Произошла ошибка при экспорте. Пожалуйста, попробуйте снова.")}finally{Z(!1),eo(0)}},e4=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{color:"title"===e?q.titleColor:q.descriptionColor,fontFamily:q.fontFamily,textAlign:el,fontSize:"".concat("title"===e?ew.title:ew.description,"px"),lineHeight:"title"===e?ej.title:ej.description,letterSpacing:"".concat("title"===e?eS.title:eS.description,"%"),transform:t?"rotate(".concat(t,"deg)"):void 0,transformOrigin:"center",display:"inline-block",width:"100%"}},[e2,e3]=(0,n.useState)(null),e5=(e,t,o)=>{e3({type:e,value:o,bannerId:t}),e6.current&&e9(e6.current)},e8=()=>{e2&&(te(x,e2.bannerId,e2.type,e2.value),e3(null))},e6=(0,n.useRef)(null),e9=e=>{e&&(e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px"))};(0,n.useEffect)(()=>{e2&&e6.current&&e9(e6.current)},[e2]);let e7=(e,t)=>{var o,n,l;let i=t===er,a=e.devicePosition||"center";console.log("Rendering banner ".concat(t,", device position:"),a);let{titlePosition:s,descriptionPosition:c,separateElements:d}=eK(a),u=(null===(o=e.verticalOffset)||void 0===o?void 0:o[N])||e.verticalOffset||{combined:0,title:0,description:0,device:0},g=(null===(n=e.horizontalOffset)||void 0===n?void 0:n[N])||e.horizontalOffset||{combined:0,title:0,description:0},f={device:ep(e,N,"device"),title:ep(e,N,"title"),description:ep(e,N,"description"),textBlock:ep(e,N,"textBlock")},m=function(t,o,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e2&&e2.type===t&&e2.bannerId===e.id,s={...l,width:"calc(100% + 30px)",display:"flex",flexDirection:"column",alignItems:"center"===el?"center":"right"===el?"flex-end":"flex-start",justifyContent:"flex-start"},c={...n,textAlign:el,width:"100%"};return a?(0,r.jsx)("div",{style:s,children:(0,r.jsx)("textarea",{ref:e6,className:"w-full bg-transparent outline-none resize-none p-1",value:e2.value,onChange:e=>{e3({...e2,value:e.target.value}),e9(e.target)},onBlur:e8,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),e8())},autoFocus:!0,style:{...c,height:"auto",minHeight:"title"===t?"2.5rem":"3.5rem",display:"block",overflow:"hidden",border:"none",background:"rgba(59, 130, 246, 0.05)",verticalAlign:"top"}})}):(0,r.jsx)("div",{className:"cursor-text w-full",onClick:()=>{i&&e5(t,e.id,o)},style:s,children:"title"===t?(0,r.jsx)("h2",{className:"text-2xl font-bold text-".concat(el),style:c,children:o||"Title"}):(0,r.jsx)("p",{className:"text-base text-".concat(el),style:c,children:o||"Description"})})};return(0,r.jsx)("div",{id:"preview-".concat(e.id),className:"relative rounded-lg pb-4 overflow-hidden banner border ".concat(i?"shadow-xl border-transparent":"border-transparent"),onClick:()=>en(t),style:{backgroundColor:e.backgroundColor||"#007AFF",width:"".concat(A.previewWidth,"px"),height:"".concat(A.previewHeight,"px"),position:"relative",margin:"0 15px"},children:(0,r.jsxs)("div",{className:"w-full h-full relative",style:{backgroundColor:e.backgroundColor},children:[(0,r.jsx)("div",{className:"absolute top-4 left-4 text-white text-xl font-mono opacity-50",children:String(e.id).padStart(2,"0")}),d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute ".concat(i?"hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50 rounded-md p-1":""," ").concat(i&&(null==eE?void 0:eE.elementType)!=="title"?"cursor-grab":""," ").concat((null==eE?void 0:eE.elementType)==="title"?"cursor-grabbing":""),style:{...s,transform:"".concat(s.transform||""," translateY(").concat(u.title,"px) translateX(").concat(g.title,"px)")},onMouseDown:t=>i&&tr(t,e.id,"title"),onDoubleClick:e=>{i&&(e.stopPropagation(),ez("title"))},children:m("title",eU(x,e.id,"title"),e4("title",f.title))}),(0,r.jsx)("div",{className:"absolute ".concat(i?"hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50 rounded-md p-1":""," ").concat(i&&(null==eE?void 0:eE.elementType)!=="description"?"cursor-grab":""," ").concat((null==eE?void 0:eE.elementType)==="description"?"cursor-grabbing":""),style:{...c,transform:"".concat(c.transform||""," translateY(").concat(u.description,"px) translateX(").concat(g.description,"px)")},onMouseDown:t=>i&&tr(t,e.id,"description"),onDoubleClick:e=>{i&&(e.stopPropagation(),ez("description"))},children:m("description",eU(x,e.id,"description"),e4("description",f.description))})]}):(0,r.jsxs)("div",{className:"absolute ".concat(i?"hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50 rounded-md p-1":""," ").concat(i&&(null==eE?void 0:eE.elementType)!=="text-block"?"cursor-grab":""," ").concat((null==eE?void 0:eE.elementType)==="text-block"?"cursor-grabbing":""),style:{...s,transform:"".concat(s.transform||""," translateY(").concat(u.combined,"px) translateX(").concat(g.combined,"px) rotate(").concat(f.textBlock,"deg)")},onMouseDown:t=>i&&tr(t,e.id,"text-block"),onDoubleClick:e=>{i&&(e.stopPropagation(),ez("text-block"))},children:[m("title",eU(x,e.id,"title"),e4("title"),{marginBottom:"0.5rem"}),m("description",eU(x,e.id,"description"),e4("description"))]}),(0,r.jsxs)("div",{id:"device-".concat(e.id),className:"absolute banner-device-target ".concat(i?"hover:ring-2 hover:ring-blue-300 hover:ring-opacity-50":""," ").concat(i&&(null==eE?void 0:eE.elementType)!=="device"?"cursor-grab":""," ").concat((null==eE?void 0:eE.elementType)==="device"?"cursor-grabbing":""),"data-banner-id":t,style:eG(e),onMouseDown:t=>{i&&!eB&&tr(t,e.id,"device")},onDoubleClick:e=>{i&&(e.stopPropagation(),ez("device"))},children:[(()=>{var t,o,n;let l=ev(e,x,N);return l&&l.file&&l.file instanceof File?(0,r.jsx)("div",{style:{borderWidth:"".concat(l.borderWidth,"px"),borderStyle:"solid",borderColor:l.borderColor,borderRadius:"".concat(l.borderRadius,"px"),overflow:"hidden"},children:(0,r.jsx)("img",{src:l.dataUrl||(l.file&&l.file instanceof File?URL.createObjectURL(l.file):"/placeholder.svg"),alt:"Screenshot ".concat(e.id),style:{width:"100%",display:"block"}},"screenshot-".concat(e.id,"-").concat(x,"-").concat(eT))}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50",style:{width:"100%",height:"".concat(A.placeholderHeight,"px"),borderWidth:"".concat((null===(t=e.screenshot)||void 0===t?void 0:t.borderWidth)||8,"px"),borderStyle:"solid",borderColor:(null===(o=e.screenshot)||void 0===o?void 0:o.borderColor)||"#000000",borderRadius:"".concat((null===(n=e.screenshot)||void 0===n?void 0:n.borderRadius)||30,"px")},children:[i&&(0,r.jsx)("input",{type:"file",id:"screenshot-upload-".concat(e.id),className:"hidden",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&eX(e.target.files[0])}}),i?(0,r.jsxs)("label",{htmlFor:"screenshot-upload-".concat(e.id),className:"cursor-pointer flex flex-col items-center",children:[(0,r.jsx)(B.A,{className:"h-12 w-12 text-gray-400"}),(0,r.jsx)("span",{className:"mt-2 text-sm text-gray-500",children:"Click or drag & drop to upload screenshot"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.A,{className:"h-12 w-12 text-gray-400"}),(0,r.jsx)("span",{className:"mt-2 text-sm text-gray-500",children:"No screenshot"})]})]})})(),i&&"device"===ek&&!Q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute -top-3 -left-3 w-6 h-6 bg-blue-500 rounded-full border-2 border-white cursor-grab hover:scale-110 transition-transform shadow-lg",style:{zIndex:1e3},onMouseDown:t=>{let o=document.getElementById("device-".concat(e.id));o&&ti(t,e.id,o,N)}}),(0,r.jsx)("div",{className:"absolute -top-3 -right-3 w-6 h-6 bg-blue-500 rounded-full border-2 border-white cursor-grab hover:scale-110 transition-transform shadow-lg",style:{zIndex:1e3},onMouseDown:t=>{let o=document.getElementById("device-".concat(e.id));o&&ti(t,e.id,o,N)}}),(0,r.jsx)("div",{className:"absolute -bottom-3 -left-3 w-6 h-6 bg-blue-500 rounded-full border-2 border-white cursor-grab hover:scale-110 transition-transform shadow-lg",style:{zIndex:1e3},onMouseDown:t=>{let o=document.getElementById("device-".concat(e.id));o&&ti(t,e.id,o,N)}}),(0,r.jsx)("div",{className:"absolute -bottom-3 -right-3 w-6 h-6 bg-blue-500 rounded-full border-2 border-white cursor-grab hover:scale-110 transition-transform shadow-lg",style:{zIndex:1e3},onMouseDown:t=>{let o=document.getElementById("device-".concat(e.id));o&&ti(t,e.id,o,N)}})]})]}),i&&!Q&&(0,r.jsxs)("div",{className:"absolute top-4 right-4 flex gap-1",children:[(0,r.jsx)(h,{variant:"ghost",size:"icon",className:"h-8 w-8 bg-black bg-opacity-30 hover:bg-opacity-50 text-white rounded-full",onClick:t=>{t.stopPropagation(),eH(e.id)},children:(0,r.jsx)(I.A,{className:"h-4 w-4"})}),((null===(l=eL[N])||void 0===l?void 0:l.length)||0)>1&&(0,r.jsx)(h,{variant:"ghost",size:"icon",className:"h-8 w-8 bg-black bg-opacity-30 hover:bg-opacity-50 text-white rounded-full",onClick:t=>{t.stopPropagation(),eY(e.id)},children:(0,r.jsx)(F.A,{className:"h-4 w-4"})})]})]})},"banner-".concat(e.id,"-").concat(N))};(0,n.useEffect)(()=>{let e=document.createElement("style");return e.textContent="\n      .drag-highlight {\n        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5), 0 0 0 6px rgba(59, 130, 246, 0.3);\n        transition: box-shadow 0.2s ease-in-out;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,n.useEffect)(()=>{if(console.log("Loading banner settings from localStorage"),window.localStorage)try{let e=localStorage.getItem("bannerSettings");if(e){let t=JSON.parse(e);G(t)}}catch(e){console.error("Error parsing banner settings:",e)}},[]),(0,n.useEffect)(()=>{if(console.log("Loading text alignment from localStorage"),window.localStorage)try{let e=localStorage.getItem("textAlignment");e&&eh(e)}catch(e){console.error("Error loading text alignment:",e)}},[]),(0,n.useEffect)(()=>{if(console.log("Loading font size from localStorage"),window.localStorage)try{let e=localStorage.getItem("fontSize");e&&ey(JSON.parse(e))}catch(e){console.error("Error parsing font size:",e)}},[]),(0,n.useEffect)(()=>{if(console.log("Loading line height and letter spacing from localStorage"),window.localStorage)try{let e=localStorage.getItem("lineHeight");e&&eN(JSON.parse(e));let t=localStorage.getItem("letterSpacing");t&&eD(JSON.parse(t))}catch(e){console.error("Error parsing line height or letter spacing:",e)}},[]);let te=(e,t,o,r)=>{console.log("Updating banner text: ".concat(e,", id=").concat(t,", ").concat(o,"=").concat(r));let n={...K};n[e]||(n[e]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""});let l="preview_".concat(t,"_").concat(o);n[e][l]=r,V(n)},[tt,to]=(0,n.useState)(!1);(0,n.useEffect)(()=>{to(!0)},[]);let tr=(e,t,o)=>{var r,n;e.preventDefault(),e.stopPropagation();let l=(eL[N]||[]).find(e=>e.id===t);if(!l)return;let i=0,a=0,s=(null===(r=l.verticalOffset)||void 0===r?void 0:r[N])||l.verticalOffset||{combined:0,title:0,description:0,device:0},c=(null===(n=l.horizontalOffset)||void 0===n?void 0:n[N])||l.horizontalOffset||{combined:0,title:0,description:0};"title"===o?(i=c.title,a=s.title):"description"===o?(i=c.description,a=s.description):"device"===o?(i=c.device||0,a=s.device):"text-block"===o&&(i=c.combined,a=s.combined),("title"===o||"description"===o||"device"===o||"text-block"===o)&&ez("text-block"===o?"title":o),eO({bannerId:t,elementType:o,deviceType:N,initialMouseX:e.clientX,initialMouseY:e.clientY,initialElementOffsetX:i,initialElementOffsetY:a})},tn=(0,n.useCallback)(e=>{if(!eE)return;let t=e.clientX-eE.initialMouseX,o=e.clientY-eE.initialMouseY,r=eE.initialElementOffsetX+t,n=eE.initialElementOffsetY+o;eW(e=>({...e,[eE.deviceType]:(e[eE.deviceType]||[]).map(e=>{if(e.id===eE.bannerId){let t={...e},o=eE.elementType;return t.verticalOffset||(t.verticalOffset={}),t.horizontalOffset||(t.horizontalOffset={}),t.verticalOffset[eE.deviceType]||(t.verticalOffset[eE.deviceType]={combined:0,title:0,description:0,device:0}),t.horizontalOffset[eE.deviceType]||(t.horizontalOffset[eE.deviceType]={combined:0,title:0,description:0}),"title"===o?(t.horizontalOffset[eE.deviceType].title=r,t.verticalOffset[eE.deviceType].title=n):"description"===o?(t.horizontalOffset[eE.deviceType].description=r,t.verticalOffset[eE.deviceType].description=n):"device"===o?(t.horizontalOffset[eE.deviceType].device=r,t.verticalOffset[eE.deviceType].device=n):"text-block"===o&&(t.horizontalOffset[eE.deviceType].combined=r,t.verticalOffset[eE.deviceType].combined=n),t}return e})}))},[eE,eW]),tl=(0,n.useCallback)(()=>{eE&&eO(null),eB&&eI(null)},[eE,eB]),ti=(e,t,o,r)=>{e.preventDefault(),e.stopPropagation();let n=(eL[r]||[]).find(e=>e.id===t);if(!n)return;let l=o.getBoundingClientRect(),i=l.left+l.width/2,a=l.top+l.height/2,s=Math.atan2(e.clientY-a,e.clientX-i)*(180/Math.PI);eI({bannerId:t,deviceType:r,initialRotation:ep(n,r,"device"),centerX:i,centerY:a,initialAngle:s})},ta=(0,n.useCallback)(e=>{if(!eB)return;let t=Math.atan2(e.clientY-eB.centerY,e.clientX-eB.centerX)*(180/Math.PI)-eB.initialAngle;t>180&&(t-=360),t<-180&&(t+=360);let o=eB.initialRotation+t;eW(e=>({...e,[eB.deviceType]:(e[eB.deviceType]||[]).map(e=>{if(e.id===eB.bannerId){let t=e.rotation||{},r="object"==typeof t[eB.deviceType]&&null!==t[eB.deviceType]?{...t[eB.deviceType]}:{device:0,title:0,description:0,textBlock:0};return r.device=Math.round(o),{...e,rotation:{...t,[eB.deviceType]:r}}}return e})}))},[eB,eW]);(0,n.useEffect)(()=>(eE?(window.addEventListener("mousemove",tn),window.addEventListener("mouseup",tl),document.body.style.userSelect="none"):(window.removeEventListener("mousemove",tn),window.removeEventListener("mouseup",tl),document.body.style.userSelect=""),eB?(window.addEventListener("mousemove",ta),window.addEventListener("mouseup",tl),document.body.style.userSelect="none",document.body.style.cursor="grabbing"):window.removeEventListener("mousemove",ta),()=>{window.removeEventListener("mousemove",tn),window.removeEventListener("mousemove",ta),window.removeEventListener("mouseup",tl),document.body.style.userSelect="",document.body.style.cursor=""}),[eE,eB,tn,ta,tl]);let ts=e=>{var t;if(1===c.length){alert("Нельзя удалить последний проект!");return}if(confirm('Удалить проект "'.concat(null===(t=c.find(t=>t.id===e))||void 0===t?void 0:t.name,'"?'))){let t=c.filter(t=>t.id!==e);d(t),g===e&&f(t[0].id),localStorage.removeItem("project_".concat(e,"_previewItems")),localStorage.removeItem("project_".concat(e,"_bannerSettings")),localStorage.removeItem("project_".concat(e,"_localizedContent")),console.log("Deleted all data for project ".concat(e))}},tc=e=>{let t=c.find(t=>t.id===e);if(!t)return;let o=prompt("Новое имя проекта:",t.name);o&&o.trim()&&d(c.map(t=>t.id===e?{...t,name:o.trim()}:t))};return(0,r.jsx)(r.Fragment,{children:tt?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)("header",{className:"fixed top-0 left-0 right-0 bg-[#2C2C2C] border-b border-[#1E1E1E] z-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-12 px-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 flex-1 overflow-x-auto",children:[c.map(e=>(0,r.jsxs)("div",{className:"group flex items-center gap-2 px-3 py-1.5 rounded cursor-pointer transition-colors ".concat(g===e.id?"bg-[#3D3D3D] text-white":"text-gray-400 hover:bg-[#353535] hover:text-gray-200"),onClick:()=>f(e.id),children:[(0,r.jsx)("span",{className:"text-xs whitespace-nowrap",children:e.name}),g===e.id&&(0,r.jsxs)("div",{className:"flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),tc(e.id)},className:"p-0.5 hover:bg-[#4D4D4D] rounded text-[10px]",title:"Rename",children:"✏️"}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),ts(e.id)},className:"p-0.5 hover:bg-red-600/20 rounded text-[10px]",title:"Delete",children:"\uD83D\uDDD1️"})]})]},e.id)),(0,r.jsx)("button",{onClick:()=>{let e=Math.max(...c.map(e=>e.id),0)+1;d([...c,{id:e,name:"Project ".concat(e),createdAt:Date.now()}]),f(e)},className:"px-2 py-1.5 bg-[#3D3D3D] text-gray-300 rounded hover:bg-[#4D4D4D] text-xs flex items-center gap-1 whitespace-nowrap",children:"+ New"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,r.jsxs)(y,{children:[(0,r.jsx)(j,{asChild:!0,children:(0,r.jsxs)(h,{variant:"outline",className:"bg-[#3D3D3D] border-[#4D4D4D] text-gray-300 hover:bg-[#4D4D4D] hover:text-white",children:[(0,r.jsx)(T.A,{className:"mr-2 h-4 w-4"}),"Import JSON"]})}),(0,r.jsxs)(D,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,r.jsx)(C,{children:(0,r.jsx)(z,{children:"Import Localized Content"})}),(0,r.jsx)("div",{className:"space-y-4 py-4",children:(0,r.jsx)("div",{className:"space-y-4 py-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{children:"Импорт из файла"}),(0,r.jsx)(u,{type:"file",accept:".json",onChange:eV,className:"mt-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{children:"Или вставьте JSON текст"}),(0,r.jsx)(p,{value:$,onChange:e=>ee(e.target.value),placeholder:"Вставьте JSON здесь...",className:"mt-2 min-h-[200px]"}),(0,r.jsx)(h,{onClick:()=>{try{let e=JSON.parse($);if(!e.global||!e.banners)throw Error("Неверный формат JSON: отсутствуют разделы global или banners");let t={};Object.entries(e.global).forEach(e=>{let[o,r]=e;t[o]||(t[o]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""}),t[o]={...t[o],title:r.title||"",description:r.description||"",promotionalText:r.promotionalText||"",whatsNew:r.whatsNew||"",keywords:r.keywords||""}}),Object.entries(e.banners).forEach(e=>{let[o,r]=e;t[o]||(t[o]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""}),Object.entries(r).forEach(e=>{let[r,n]=e;t[o]["".concat(r,"_title")]=n.title||"",t[o]["".concat(r,"_description")]=n.description||""})}),V(t),ee(""),alert("JSON успешно импортирован!")}catch(e){console.error("Ошибка при импорте JSON:",e),alert("Ошибка при импорте JSON. Проверьте формат текста.")}},className:"mt-2",disabled:!$,children:"Импортировать из текста"})]})]})})})]})]}),(0,r.jsxs)(h,{variant:"outline",className:"bg-[#3D3D3D] border-[#4D4D4D] text-gray-300 hover:bg-[#4D4D4D] hover:text-white",onClick:()=>{let e={global:{},banners:{}};ea.forEach(t=>{let{code:o}=t;e.global[o]||(e.global[o]={title:"ru"===o&&eM(o,"title")||"",description:"ru"===o&&eM(o,"description")||"",promotionalText:"ru"===o&&eM(o,"promotionalText")||"",whatsNew:"ru"===o&&eM(o,"whatsNew")||"",keywords:"ru"===o&&eM(o,"keywords")||""}),e.banners[o]||(e.banners[o]={}),(eL[N]||[]).forEach(t=>{let r="preview_".concat(t.id);e.banners[o][r]={title:"ru"===o&&eU(o,t.id,"title")||"",description:"ru"===o&&eU(o,t.id,"description")||""}})});let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download="localized_content.json",document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(o)},0)},children:[(0,r.jsx)(R.A,{className:"mr-2 h-4 w-4"}),"Export JSON"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex rounded border border-[#1E1E1E] p-0.5 bg-[#1E1E1E] h-9",children:[(0,r.jsx)("button",{onClick:()=>eA("iphone"),className:"px-3 py-1.5 rounded text-xs font-medium transition-colors ".concat("iphone"===N?"bg-[#0D99FF] text-white":"text-gray-400 hover:bg-[#3D3D3D] hover:text-gray-200"),children:"iPhone"}),(0,r.jsx)("button",{onClick:()=>eA("ipad"),className:"px-3 py-1.5 rounded text-xs font-medium transition-colors ".concat("ipad"===N?"bg-[#0D99FF] text-white":"text-gray-400 hover:bg-[#3D3D3D] hover:text-gray-200"),children:"iPad"})]}),(0,r.jsx)(ei,{languages:ea,activeLanguage:x,onChange:e=>{if(console.log("\uD83C\uDF10 handleLanguageChange: Changing language from ".concat(x," to ").concat(e)),b(e),!K[e]){let t={...K};t[e]={title:"",description:"",promotionalText:"",whatsNew:"",keywords:""},V(t)}console.log("\uD83C\uDF10 handleLanguageChange: Language changed to ".concat(e))}})]}),(0,r.jsxs)(y,{children:[(0,r.jsx)(j,{asChild:!0,children:(0,r.jsx)(h,{className:"bg-yellow-500 hover:bg-yellow-600 text-black font-medium",disabled:Q,children:Q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Exporting ",Math.round(et),"%"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.A,{className:"mr-2 h-4 w-4"}),"Export All Images"]})})}),(0,r.jsxs)(D,{className:"sm:max-w-md",children:[(0,r.jsxs)(C,{children:[(0,r.jsx)(z,{children:"Экспорт изображений"}),(0,r.jsx)(E,{children:"Выберите локали для экспорта изображений"})]}),(0,r.jsxs)("div",{className:"py-4",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,r.jsx)(h,{variant:"outline",size:"sm",onClick:()=>e0(!0),children:"Выбрать все"}),(0,r.jsx)(h,{variant:"outline",size:"sm",onClick:()=>e0(!1),children:"Отменить все"})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4",children:ea.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"lang-".concat(e.code),checked:eQ[e.code],onChange:()=>e$(e.code),className:"rounded border-gray-300"}),(0,r.jsxs)("label",{htmlFor:"lang-".concat(e.code),className:"text-sm font-medium",children:[e.name," (",e.code,")"]})]},e.code))})]}),(0,r.jsx)(k,{children:(0,r.jsx)(h,{onClick:e1,disabled:Q||Object.values(eQ).every(e=>!e),children:Q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Экспорт ",Math.round(et),"%"]}):"Экспортировать"})})]})]})]})]})}),(0,r.jsx)("div",{className:"flex-grow container mx-auto px-4 py-6 mt-[48px]",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6",children:[(0,r.jsx)("div",{children:(0,r.jsx)(M,{className:"overflow-hidden",children:(0,r.jsx)(U,{className:"p-0",children:(0,r.jsx)("div",{className:"bg-gray-100 p-6 flex flex-col min-h-[800px]",onClick:e=>{e.target===e.currentTarget&&ez("banner")},children:(0,r.jsxs)("div",{ref:eC,className:"flex overflow-x-auto pb-4 pt-2 px-2 -mx-2 mb-4 snap-x",style:{scrollbarWidth:"thin"},children:[(eL[N]||[]).map((e,t)=>e7(e,t)),(0,r.jsx)("div",{className:"flex items-center justify-center border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-primary hover:bg-gray-50",style:{width:"".concat(A.previewWidth,"px"),height:"".concat(A.previewHeight,"px"),flexShrink:0,margin:"0 8px"},onClick:()=>{let e=[...(eL.iphone||[]).map(e=>e.id),...(eL.ipad||[]).map(e=>e.id)],t=e.length>0?Math.max(...e)+1:1,o=["#FFD700","#F5F5DC","#FF6347","#FFDAB9","#87CEEB","#98FB98","#DDA0DD","#F0E68C"],r=o[Math.floor(Math.random()*o.length)],n={id:t,name:"Preview ".concat(t),backgroundColor:r,devicePosition:"center",deviceScale:100,verticalOffset:{iphone:{combined:0,title:0,description:0,device:0},ipad:{combined:0,title:0,description:0,device:0},combined:0,title:0,description:0,device:0},horizontalOffset:{iphone:{combined:0,title:0,description:0},ipad:{combined:0,title:0,description:0},combined:0,title:0,description:0},screenshot:{file:null,borderColor:"#000000",borderWidth:8,borderRadius:30}};eW(e=>({...e,[N]:[...e[N]||[],n]})),setTimeout(()=>{eC.current&&(eC.current.scrollLeft=eC.current.scrollWidth)},100)},children:(0,r.jsx)(W.A,{className:"h-12 w-12 text-gray-400"})})]})})})})}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"fixed top-0 right-0 h-screen w-[320px] z-40",style:{paddingTop:"48px"},children:(0,r.jsx)(M,{className:"h-full rounded-none border-l border-t-0 border-r-0 border-b-0",children:(0,r.jsx)(U,{className:"p-6 h-full overflow-y-auto",children:(()=>{var e,t,o,n,l,i,a,s,c,d,h,g,f,v,b,w,y,j;let S=(eL[N]||[])[er]||{};switch(ek){case"none":case"banner":return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-base font-medium font-mono",children:"Banner Settings"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Background Color"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(ed,{color:S.backgroundColor||"#007AFF",onChange:e=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],backgroundColor:e},eW(e=>({...e,[N]:t})))}})})]}),(0,r.jsx)(H,{className:"my-4"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"text-xs font-medium text-gray-500 font-mono",children:"Localized App Information"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Promotional Text"}),(0,r.jsx)(p,{value:eM(x,"promotionalText")||"",onChange:e=>{eJ(x,"promotionalText",e.target.value)},className:"mt-1",rows:4,placeholder:"Promotional text in ".concat(x)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Description"}),(0,r.jsx)(p,{value:eM(x,"description")||"",onChange:e=>{eJ(x,"description",e.target.value)},className:"mt-1",rows:4,placeholder:"Description in ".concat(x)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"What's New in This Version"}),(0,r.jsx)(p,{value:eM(x,"whatsNew")||"",onChange:e=>{eJ(x,"whatsNew",e.target.value)},className:"mt-1",rows:4,placeholder:"What's new in ".concat(x)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Keywords"}),(0,r.jsx)(u,{value:eM(x,"keywords")||"",onChange:e=>{eJ(x,"keywords",e.target.value)},className:"mt-1",placeholder:"Keywords in ".concat(x)})]})]})]})});case"title":case"description":let D="title"===ek;return(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h3",{className:"text-base font-semibold font-mono",children:D?"Заголовок":"Описание"}),(0,r.jsx)(m,{className:"text-xs text-gray-500 font-mono",children:D?"Текст заголовка":"Текст описания"}),(0,r.jsx)(p,{value:eU(x,S.id,D?"title":"description")||"",onChange:e=>{te(x,S.id,D?"title":"description",e.target.value)},className:"mt-1",placeholder:D?"Введите заголовок...":"Введите описание..."})]}),(0,r.jsxs)("div",{className:"space-y-3 mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:D?"Вертикальное смещение заголовка":"Вертикальное смещение описания"})}),(0,r.jsx)(eb,{value:(null===(e=S.verticalOffset)||void 0===e?void 0:e[D?"title":"description"])||0,onChange:e=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],verticalOffset:{...t[er].verticalOffset,[D?"title":"description"]:e}},eW(e=>({...e,[N]:t})))},min:-300,max:300,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:D?"Горизонтальное смещение заголовка":"Горизонтальное смещение описания"})}),(0,r.jsx)(eb,{value:(null===(t=S.horizontalOffset)||void 0===t?void 0:t[D?"title":"description"])||0,onChange:e=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],horizontalOffset:{...t[er].horizontalOffset,[D?"title":"description"]:e}},eW(e=>({...e,[N]:t})))},min:-300,max:300,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:D?"Поворот заголовка":"Поворот описания"})}),(0,r.jsx)(eb,{value:ep(S,N,D?"title":"description"),onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er].rotation||{},r="object"==typeof o[N]&&null!==o[N]?{...o[N]}:{device:0,title:0,description:0,textBlock:0};r[D?"title":"description"]=e,t[er]={...t[er],rotation:{...o,[N]:r}},eW(e=>({...e,[N]:t}))}},min:-180,max:180,unit:"\xb0"})]})]})]})});case"text-block":return(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-base font-semibold font-mono",children:"Блок текста"}),(0,r.jsxs)("div",{className:"space-y-3 mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Вертикальное смещение блока"})}),(0,r.jsx)(eb,{value:(null===(o=S.verticalOffset)||void 0===o?void 0:o.combined)||0,onChange:e=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],verticalOffset:{...t[er].verticalOffset,combined:e}},eW(e=>({...e,[N]:t})))},min:-300,max:300,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Горизонтальное смещение блока"})}),(0,r.jsx)(eb,{value:(null===(n=S.horizontalOffset)||void 0===n?void 0:n.combined)||0,onChange:e=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],horizontalOffset:{...t[er].horizontalOffset,combined:e}},eW(e=>({...e,[N]:t})))},min:-300,max:300,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"font-mono",children:"Поворот блока"})}),(0,r.jsx)(eb,{value:ep(S,N,"textBlock"),onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er].rotation||{},r="object"==typeof o[N]&&null!==o[N]?{...o[N]}:{device:0,title:0,description:0,textBlock:0};r.textBlock=e,t[er]={...t[er],rotation:{...o,[N]:r}},eW(e=>({...e,[N]:t}))}},min:-180,max:180,unit:"\xb0"})]})]})]})});case"device":return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-base font-medium font-mono",children:"Device Settings"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Position"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-0.5 mt-1",children:ec.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>{let t=[...eL[N]||[]];t[er]&&(t[er]={...t[er],devicePosition:e.value},eW(e=>({...e,[N]:t})))},className:"p-0.5 rounded-md border ".concat(S.devicePosition===e.value?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"),title:e.label,children:{"top-left":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"4",y:"4",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"14",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"top-center":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"9",y:"4",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"14",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"top-right":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"14",y:"4",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"14",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"center-left":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"4",y:"9",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"14",y:"9",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),center:(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"4",y:"2",width:"16",height:"4",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"9",y:"9",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"18",width:"16",height:"4",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]}),"center-right":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"14",y:"9",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"9",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"bottom-left":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"4",y:"14",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"4",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"bottom-center":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"9",y:"14",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"4",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]}),"bottom-right":(0,r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-3 w-3 mx-auto",children:[(0,r.jsx)("rect",{x:"14",y:"14",width:"6",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),(0,r.jsx)("rect",{x:"4",y:"4",width:"16",height:"6",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeDasharray:"2 2"})]})}[e.value]||(0,r.jsx)(O.A,{className:"h-4 w-4 mx-auto"})},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Device Scale"})}),(0,r.jsx)(eb,{value:em(S,N),onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er].deviceScale,r="object"==typeof o&&null!==o?{...o}:{iphone:100,ipad:100};r[N]=e,t[er]={...t[er],deviceScale:r},eW(e=>({...e,[N]:t}))}},min:50,max:500,unit:"%"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Vertical Position"})}),(0,r.jsx)(eb,{value:(null===(s=eL[N])||void 0===s?void 0:null===(a=s[er])||void 0===a?void 0:null===(i=a.verticalOffset)||void 0===i?void 0:null===(l=i[N])||void 0===l?void 0:l.device)||(null===(h=eL[N])||void 0===h?void 0:null===(d=h[er])||void 0===d?void 0:null===(c=d.verticalOffset)||void 0===c?void 0:c.device)||0,onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er];o.verticalOffset||(o.verticalOffset={}),o.verticalOffset[N]||(o.verticalOffset[N]={combined:0,title:0,description:0,device:0}),o.verticalOffset[N].device=e,eW(e=>({...e,[N]:t}))}},min:-300,max:300,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Horizontal Position"})}),(0,r.jsx)(eb,{value:(null===(b=eL[N])||void 0===b?void 0:null===(v=b[er])||void 0===v?void 0:null===(f=v.horizontalOffset)||void 0===f?void 0:null===(g=f[N])||void 0===g?void 0:g.device)||0,onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er];o.horizontalOffset||(o.horizontalOffset={}),o.horizontalOffset[N]||(o.horizontalOffset[N]={combined:0,title:0,description:0,device:0}),o.horizontalOffset[N].device=e,eW(e=>({...e,[N]:t}))}},min:-300,max:300,unit:"px"})]}),(0,r.jsx)(H,{}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-base font-medium font-mono",children:"Border Settings"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m,{className:"text-xs font-mono",children:"Border Color"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(ed,{color:(null===(w=S.screenshot)||void 0===w?void 0:w.borderColor)||"#000000",onChange:e=>eq("borderColor",e)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Border Width"})}),(0,r.jsx)(eb,{value:(null===(y=S.screenshot)||void 0===y?void 0:y.borderWidth)||8,onChange:e=>eq("borderWidth",e),min:0,max:20,unit:"px"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Border Radius"})}),(0,r.jsx)(eb,{value:(null===(j=S.screenshot)||void 0===j?void 0:j.borderRadius)||30,onChange:e=>eq("borderRadius",e),min:0,max:60,unit:"px"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,r.jsx)(m,{className:"text-xs font-mono",children:"Rotation"})}),(0,r.jsx)(eb,{value:ep(S,N,"device"),onChange:e=>{let t=[...eL[N]||[]];if(t[er]){let o=t[er].rotation||{},r="object"==typeof o[N]&&null!==o[N]?{...o[N]}:{device:0,title:0,description:0,textBlock:0};r.device=e,t[er]={...t[er],rotation:{...o,[N]:r}},eW(e=>({...e,[N]:t}))}},min:-360,max:360,unit:"\xb0"})]})]})});default:return null}})()})})})})]})})]}):null})}}},e=>{var t=t=>e(e.s=t);e.O(0,[316,173,441,517,358],()=>t(8833)),_N_E=e.O()}]);